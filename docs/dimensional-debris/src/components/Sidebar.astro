---
import semver from "semver";
import type { Props } from "@astrojs/starlight/props";
import Default from "@astrojs/starlight/components/Sidebar.astro";

const { sidebar: originalSidebar } = Astro.props;

const sortEntries = (entries: Props["sidebar"]) =>
  entries.sort((a, b) => {
    if (a.type !== "link" || b.type !== "link")
      throw new Error("Unexpected entry type");
    return semver.compare(b.label, a.label);
  });

const sidebar = originalSidebar.map((group) => {
  if (group.type !== "group") return group;
  if (group.label !== "Changelogs") return group;

  return {
    ...group,
    entries: sortEntries(group.entries),
  };
});
---

<Default {...Astro.props} sidebar={sidebar} />
